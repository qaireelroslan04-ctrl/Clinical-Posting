<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Long Case Medical Companion</title>
    <style>
        /* --- CSS VARIABLES --- */
        :root {
            /* Dark Mode (Midnight) */
            --bg-body: #000000;
            --bg-sidebar: #050505;
            --bg-card: #0a0a0a;
            --bg-box: #111111;
            --bg-input: #171717;
            --border-color: #27272a; /* Subtler dark border */
            --text-main: #e2e8f0;
            --text-muted: #94a3b8;
            --accent-color: #3b82f6;
            --accent-bg: #172554;
            --accent-text: #bfdbfe;
            --header-bg: rgba(0, 0, 0, 0.85);
            --shadow-card: none;
            
            /* Special Box Colors (Dark) */
            --box-green-bg: rgba(6, 78, 59, 0.3); --box-green-border: #059669; --box-green-text: #d1fae5;
            --box-blue-bg: rgba(30, 58, 138, 0.3); --box-blue-border: #2563eb; --box-blue-text: #dbeafe;
            --box-red-bg: rgba(127, 29, 29, 0.3); --box-red-border: #dc2626; --box-red-text: #fee2e2;
            --box-purple-bg: rgba(88, 28, 135, 0.3); --box-purple-border: #9333ea; --box-purple-text: #f3e8ff;
            --box-yellow-bg: rgba(120, 53, 15, 0.3); --box-yellow-border: #d97706; --box-yellow-text: #fef3c7;
        }

        [data-theme="light"] {
            /* Light Mode (Clinical White/Blue) */
            --bg-body: #f0f4f8; /* Soft blue-grey tint */
            --bg-sidebar: #ffffff;
            --bg-card: #ffffff;
            --bg-box: #f8fafc;
            --bg-input: #f1f5f9;
            --border-color: #e2e8f0;
            --text-main: #1e293b; /* Deep slate */
            --text-muted: #64748b;
            --accent-color: #0284c7; /* Clinical blue */
            --accent-bg: #e0f2fe;
            --accent-text: #0c4a6e;
            --header-bg: rgba(255, 255, 255, 0.95);
            --shadow-card: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);

            /* Special Box Colors (Light - Softer) */
            --box-green-bg: #f0fdf4; --box-green-border: #22c55e; --box-green-text: #14532d;
            --box-blue-bg: #eff6ff; --box-blue-border: #3b82f6; --box-blue-text: #1e3a8a;
            --box-red-bg: #fef2f2; --box-red-border: #ef4444; --box-red-text: #7f1d1d;
            --box-purple-bg: #faf5ff; --box-purple-border: #a855f7; --box-purple-text: #581c87;
            --box-yellow-bg: #fffbeb; --box-yellow-border: #f59e0b; --box-yellow-text: #78350f;
        }

        /* --- RESET & BASE --- */
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: background-color 0.3s, color 0.3s;
            line-height: 1.6;
        }

        /* --- HEADER --- */
        header {
            background-color: var(--header-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            padding: 0.75rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            z-index: 50;
        }
        .logo-area { display: flex; align-items: center; gap: 0.75rem; }
        h1 { font-size: 1.25rem; font-weight: 800; letter-spacing: -0.02em; color: var(--accent-color); }
        .badge { 
            background: var(--accent-bg); color: var(--accent-text); border: 1px solid var(--accent-color);
            font-size: 0.65rem; padding: 2px 8px; border-radius: 12px; font-weight: 600; text-transform: uppercase; 
        }

        /* --- LAYOUT --- */
        .main-container { display: flex; flex: 1; overflow: hidden; position: relative; }

        aside {
            width: 340px;
            background: var(--bg-sidebar);
            border-right: 1px solid var(--border-color);
            display: flex; flex-direction: column;
            overflow-y: auto;
            z-index: 40;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .search-box {
            padding: 1rem;
            background: var(--bg-sidebar);
            position: sticky; top: 0; z-index: 5;
            border-bottom: 1px solid var(--border-color);
        }
        .search-input {
            width: 100%; padding: 0.85rem;
            background-color: var(--bg-input);
            border: 1px solid var(--border-color);
            color: var(--text-main);
            border-radius: 0.5rem; font-size: 0.95rem; outline: none;
            transition: border-color 0.2s;
        }
        .search-input:focus { border-color: var(--accent-color); }

        .case-list { padding: 0.5rem; padding-bottom: 3rem; }
        
        .category-header {
            font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em;
            color: var(--text-muted); font-weight: 800;
            padding: 1.5rem 0.5rem 0.5rem 0.75rem;
            margin-top: 0.5rem;
            border-bottom: 1px solid var(--border-color);
            opacity: 0.9;
        }
        .category-header:first-child { margin-top: 0; padding-top: 0.5rem; }

        .case-btn {
            width: 100%; text-align: left; padding: 1rem 0.75rem;
            background: none; border: none; cursor: pointer;
            color: var(--text-main); font-weight: 500; font-size: 0.95rem;
            border-radius: 0.5rem; margin-bottom: 4px;
            transition: all 0.2s;
        }
        .case-btn:hover { background-color: var(--bg-input); }
        .case-btn.active {
            background-color: var(--accent-bg); color: var(--accent-text);
            font-weight: 700; border-left: 3px solid var(--accent-color);
        }

        /* --- CONTENT --- */
        main {
            flex: 1; overflow-y: auto; padding: 0 2rem 4rem 2rem;
            background-color: var(--bg-body);
            scroll-behavior: smooth;
        }

        .welcome-state {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100%; text-align: center; color: var(--text-muted); padding: 2rem;
        }

        .case-details { max-width: 1000px; margin: 0 auto; display: none; padding-bottom: 6rem; }
        .case-details.active { display: block; animation: fadeIn 0.4s ease-in-out; }

        .details-header {
            margin-bottom: 1rem; border-bottom: 1px solid var(--border-color);
            padding: 2rem 0 1rem 0; display: flex; flex-direction: column; gap: 0.5rem;
        }
        .category-tag { font-size: 0.8rem; color: var(--accent-color); font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        h2 { font-size: 2rem; color: var(--text-main); font-weight: 800; line-height: 1.2; margin: 0; }

        .theme-toggle {
            background: none; border: 1px solid var(--border-color); color: var(--text-main);
            cursor: pointer; padding: 0.5rem; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; width: 40px; height: 40px;
        }
        .theme-toggle svg { width: 20px; height: 20px; fill: currentColor; }

        /* --- FLOATING TABS (Glassmorphism) --- */
        .tabs-wrapper {
            position: sticky; top: 0; z-index: 10;
            padding: 1rem 0 1rem 0;
            /* Transparent bg with strong blur */
            backdrop-filter: blur(16px) saturate(180%);
            -webkit-backdrop-filter: blur(16px) saturate(180%);
            background-color: transparent; /* Ensure transparency */
            /* Gradient mask to fade out bottom edge slightly */
            mask-image: linear-gradient(to bottom, black 85%, transparent 100%);
            -webkit-mask-image: linear-gradient(to bottom, black 85%, transparent 100%);
            
            margin: 0 -2rem 1.5rem -2rem; 
            padding-left: 2rem; padding-right: 2rem;
        }
        
        .tabs {
            display: flex; padding: 0.25rem;
            overflow-x: auto; gap: 0.75rem;
            scrollbar-width: none; -ms-overflow-style: none;
        }
        .tabs::-webkit-scrollbar { display: none; }
        
        .tab-btn {
            flex: 0 0 auto; padding: 0.65rem 1.2rem; 
            border: 1px solid var(--border-color); background: rgba(30, 30, 30, 0.6); 
            cursor: pointer; border-radius: 2rem; 
            font-weight: 600; color: var(--text-muted);
            font-size: 0.9rem; white-space: nowrap; 
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex; align-items: center; gap: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .tab-btn:hover { background: var(--bg-input); color: var(--text-main); transform: translateY(-1px); }
        
        .tab-btn.active { 
            background: var(--bg-card); color: var(--text-main); 
            border-color: var(--accent-color);
            box-shadow: 0 8px 15px rgba(0,0,0,0.3); 
            transform: translateY(-2px);
        }
        
        /* Tab specific active colors */
        [data-theme="dark"] .tab-btn.clerking.active { color: #6ee7b7; border-color: #059669; background: #064e3b; }
        [data-theme="light"] .tab-btn.clerking.active { color: #065f46; border-color: #10b981; background: #d1fae5; }
        
        [data-theme="dark"] .tab-btn.complications.active { color: #fca5a5; border-color: #dc2626; background: #7f1d1d; }
        [data-theme="light"] .tab-btn.complications.active { color: #991b1b; border-color: #ef4444; background: #fef2f2; }

        [data-theme="dark"] .tab-btn.pearls.active { color: #c084fc; border-color: #9333ea; background: #581c87; }
        [data-theme="light"] .tab-btn.pearls.active { color: #5b21b6; border-color: #8b5cf6; background: #f5f3ff; }

        /* --- CONTENT CARD --- */
        .content-card {
            background: var(--bg-card); 
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-card);
            border-radius: 1rem; padding: 2.5rem; min-height: 500px;
        }
        .tab-content { display: none; line-height: 1.8; color: var(--text-main); font-size: 1.05rem; }
        .tab-content.active { display: block; animation: fadeIn 0.3s; }

        /* Typography */
        h3 {
            font-size: 1.35rem; color: var(--text-main); margin: 2.5rem 0 1.25rem 0;
            font-weight: 800; border-left: 5px solid var(--accent-color); padding-left: 1rem;
            letter-spacing: -0.01em; line-height: 1.3;
        }
        h3:first-child { margin-top: 0; }
        p { margin-bottom: 1.2rem; }
        ul { padding-left: 1.5rem; margin-bottom: 1.5rem; }
        li { margin-bottom: 0.5rem; padding-left: 0.25rem; }
        strong { color: var(--text-main); font-weight: 700; }
        em { color: var(--text-muted); font-style: normal; font-weight: 600; font-size: 0.95em; }

        /* Special Boxes */
        .box { 
            padding: 1.75rem; 
            border-radius: 0.75rem; 
            margin-bottom: 2rem; 
            border-left: 4px solid; 
            background: var(--bg-box);
            /* Ensure text inside doesn't hit the border */
        }
        .box-red { background: var(--box-red-bg); border-color: var(--box-red-border); color: var(--box-red-text); }
        .box-green { background: var(--box-green-bg); border-color: var(--box-green-border); color: var(--box-green-text); }
        .box-blue { background: var(--box-blue-bg); border-color: var(--box-blue-border); color: var(--box-blue-text); }
        .box-purple { background: var(--box-purple-bg); border-color: var(--box-purple-border); color: var(--box-purple-text); }
        .box-yellow { background: var(--box-yellow-bg); border-color: var(--box-yellow-border); color: var(--box-yellow-text); }
        
        .box-title { 
            display: block; 
            font-weight: 800; 
            font-size: 0.85rem; 
            text-transform: uppercase; 
            margin-bottom: 1rem; 
            letter-spacing: 0.05em; 
            opacity: 0.95; 
        }

        /* Pearl Box */
        .pearl-box {
            background-color: var(--bg-box); border: 1px solid var(--box-purple-border);
            border-radius: 0.75rem; padding: 1.75rem; margin-bottom: 1.5rem;
            position: relative; overflow: hidden;
        }
        .pearl-box::before {
            content: "üíé"; position: absolute; right: 1rem; top: 1rem; font-size: 3rem; opacity: 0.1;
        }
        .pearl-title {
            color: var(--box-purple-text); font-weight: 800; font-size: 1.2rem;
            margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem;
        }

        /* --- MOBILE --- */
        .menu-toggle { display: none; background: none; border: none; color: var(--text-main); font-size: 1.5rem; cursor: pointer; }
        .backdrop { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 35; backdrop-filter: blur(5px); }

        @media (max-width: 768px) {
            .menu-toggle { display: block; margin-right: 0.5rem; }
            h1 { font-size: 1rem; }
            aside { position: absolute; height: 100%; width: 85%; transform: translateX(-100%); }
            aside.open { transform: translateX(0); box-shadow: 10px 0 30px rgba(0,0,0,0.5); }
            .backdrop.open { display: block; }
            main { padding: 0 1rem 6rem 1rem; }
            .content-card { padding: 0; border: none; background: transparent; box-shadow: none; }
            .box, .pearl-box { padding: 1.25rem; }
            .tabs-wrapper { margin: 0 -1rem 1rem -1rem; padding-left: 1rem; padding-right: 1rem; }
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <header>
        <div style="display: flex; align-items: center;">
            <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
            <div class="logo-area">
                <span style="font-size: 1.2rem;">‚öïÔ∏è</span>
                <h1>Long Case Companion</h1>
            </div>
        </div>
        <button class="theme-toggle" onclick="toggleTheme()">
            <svg id="sun-icon" style="display:none" viewBox="0 0 24 24"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"></path></svg>
            <svg id="moon-icon" viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-3.03 0-5.5-2.47-5.5-5.5 0-1.82.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"></path></svg>
        </button>
    </header>

    <div class="main-container">
        <div class="backdrop" id="backdrop" onclick="toggleSidebar()"></div>
        
        <aside id="sidebar">
            <div class="search-box">
                <input type="text" id="searchInput" class="search-input" placeholder="Search cases...">
            </div>
            <div id="caseList" class="case-list"></div>
        </aside>

        <main>
            <div id="welcomeState" class="welcome-state">
                <div style="font-size: 5rem; margin-bottom: 1.5rem; opacity: 0.3;">ü©ª</div>
                <h2>Clinical Clerkship Companion</h2>
                <p>Select a disease to view detailed notes.<br>Optimized for ward rounds.</p>
                <!-- Loading indicator fallback -->
                <p id="loadingMsg" style="margin-top:2rem; color: var(--accent-color); display:none;">Loading Data...</p>
                <p id="errorMsg" style="margin-top:2rem; color: var(--box-red-border); display:none; max-width:400px; font-size:0.9rem; border:1px solid var(--border-color); padding:1rem; border-radius:0.5rem;">
                    <strong>‚ö†Ô∏è Data Load Error</strong><br><br>
                    Unable to load 'medical_data.json'.<br><br>
                    If you are opening this file directly from your computer, your browser may block it for security. Try running a local server (e.g. VS Code Live Server).
                </p>
            </div>

            <div id="caseDetails" class="case-details">
                <div class="details-header">
                    <div>
                        <div id="categoryTag" class="category-tag">Category</div>
                        <h2 id="caseTitle">Condition Name</h2>
                    </div>
                    <div class="header-actions">
                        <button class="copy-btn" onclick="copyContent()">
                            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg>
                            <span>Copy Data</span>
                        </button>
                    </div>
                </div>

                <div class="tabs-wrapper">
                    <div class="tabs">
                        <button class="tab-btn active clerking" onclick="switchTab('clerking', this)">üìù Clerking</button>
                        <button class="tab-btn" onclick="switchTab('history', this)">üìú History</button>
                        <button class="tab-btn" onclick="switchTab('etiology', this)">üß¨ Etiology</button>
                        <button class="tab-btn" onclick="switchTab('exam', this)">ü©∫ Examination</button>
                        <button class="tab-btn" onclick="switchTab('inv', this)">üî¨ Investigations</button>
                        <button class="tab-btn" onclick="switchTab('mgmt', this)">üíä Management</button>
                        <button class="tab-btn complications" onclick="switchTab('complications', this)">‚ö†Ô∏è Complications</button>
                        <button class="tab-btn pearls" onclick="switchTab('pearls', this)">üíé Pearls</button>
                    </div>
                </div>

                <div class="content-card">
                    <div id="tab-clerking" class="tab-content active"></div>
                    <div id="tab-history" class="tab-content"></div>
                    <div id="tab-etiology" class="tab-content"></div>
                    <div id="tab-exam" class="tab-content"></div>
                    <div id="tab-inv" class="tab-content"></div>
                    <div id="tab-mgmt" class="tab-content"></div>
                    <div id="tab-complications" class="tab-content"></div>
                    <div id="tab-pearls" class="tab-content"></div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- THEME ---
        const body = document.documentElement;
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');

        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            body.setAttribute('data-theme', savedTheme);
            updateIcons(savedTheme);
        }
        function toggleTheme() {
            const current = body.getAttribute('data-theme');
            const next = current === 'dark' ? 'light' : 'dark';
            body.setAttribute('data-theme', next);
            localStorage.setItem('theme', next);
            updateIcons(next);
        }
        function updateIcons(theme) {
            if (theme === 'dark') {
                sunIcon.style.display = 'none';
                moonIcon.style.display = 'block';
            } else {
                sunIcon.style.display = 'block';
                moonIcon.style.display = 'none';
            }
        }
        initTheme();

        // --- APP LOGIC ---

        const caseListEl = document.getElementById('caseList');
        const searchInput = document.getElementById('searchInput');
        const welcomeState = document.getElementById('welcomeState');
        const caseDetails = document.getElementById('caseDetails');
        const sidebar = document.getElementById('sidebar');
        const backdrop = document.getElementById('backdrop');
        const loadingMsg = document.getElementById('loadingMsg');
        const errorMsg = document.getElementById('errorMsg');

        // Global variable to hold the fetched data
        let medicalData = [];

        async function initApp() {
            loadingMsg.style.display = 'block';
            try {
                const response = await fetch('medical_data.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                medicalData = await response.json();
                loadingMsg.style.display = 'none';
                renderList();
            } catch (e) {
                console.error("Failed to load medical data:", e);
                loadingMsg.style.display = 'none';
                errorMsg.style.display = 'block';
            }
        }

        function renderList(filter = '') {
            caseListEl.innerHTML = '';
            
            // Get unique categories
            const categories = [...new Set(medicalData.map(item => item.category))];
            
            let foundAny = false;

            categories.forEach(cat => {
                const itemsInCat = medicalData.filter(item => 
                    item.category === cat && 
                    item.name.toLowerCase().includes(filter.toLowerCase())
                );

                if (itemsInCat.length > 0) {
                    foundAny = true;
                    // Add Category Header
                    const header = document.createElement('div');
                    header.className = 'category-header';
                    header.innerText = cat;
                    caseListEl.appendChild(header);

                    // Add Items
                    itemsInCat.forEach(item => {
                        const btn = document.createElement('button');
                        btn.className = 'case-btn';
                        btn.onclick = () => selectCase(item.id, btn);
                        btn.innerHTML = item.name;
                        caseListEl.appendChild(btn);
                    });
                }
            });

            if (!foundAny && medicalData.length > 0) {
                caseListEl.innerHTML = '<div style="padding:2rem; text-align:center; color:var(--text-muted); font-size:0.9rem;">No matches found</div>';
            }
        }

        function selectCase(id, btnElement) {
            document.querySelectorAll('.case-btn').forEach(b => b.classList.remove('active'));
            if(btnElement) btnElement.classList.add('active');

            const data = medicalData.find(d => d.id === id);
            
            document.getElementById('categoryTag').innerText = data.category;
            document.getElementById('caseTitle').innerText = data.name;
            
            const sections = ['clerking', 'history', 'etiology', 'exam', 'inv', 'mgmt', 'complications', 'pearls'];
            sections.forEach(sec => {
                document.getElementById(`tab-${sec}`).innerHTML = data[sec] || '<div class="box box-blue">Data coming soon...</div>';
            });

            welcomeState.style.display = 'none';
            caseDetails.classList.add('active');
            
            const clerkTabBtn = document.querySelector('.tab-btn.clerking');
            if(clerkTabBtn) switchTab('clerking', clerkTabBtn);

            if(window.innerWidth <= 768) toggleSidebar(false);
            
            document.querySelector('main').scrollTop = 0;
        }

        function switchTab(tabId, btn) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(`tab-${tabId}`).classList.add('active');
        }

        function toggleSidebar(forceState) {
            const isOpen = sidebar.classList.contains('open');
            const shouldOpen = forceState !== undefined ? forceState : !isOpen;
            
            if (shouldOpen) {
                sidebar.classList.add('open');
                backdrop.classList.add('open');
            } else {
                sidebar.classList.remove('open');
                backdrop.classList.remove('open');
            }
        }

        function copyContent() {
            const title = document.getElementById('caseTitle').innerText;
            const strip = (html) => {
                let tmp = document.createElement("DIV");
                tmp.innerHTML = html;
                return tmp.innerText;
            };

            const sections = ['clerking', 'history', 'etiology', 'exam', 'inv', 'mgmt', 'complications', 'pearls'];
            let text = `CONDITION: ${title}\n\n`;
            
            sections.forEach(sec => {
                const content = document.getElementById(`tab-${sec}`).innerHTML;
                if(content) text += `[${sec.toUpperCase()}]\n${strip(content)}\n\n`;
            });
            
            navigator.clipboard.writeText(text).then(() => {
                const btnSpan = document.querySelector('.copy-btn span');
                const orig = btnSpan.innerText;
                btnSpan.innerText = "Copied!";
                setTimeout(() => btnSpan.innerText = orig, 2000);
            });
        }

        searchInput.addEventListener('input', (e) => renderList(e.target.value));
        
        // Start the app
        initApp();

    </script>
</body>
</html>